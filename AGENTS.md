# goodgood.today — AGENTS.md (Authoritative Instructions)

## One-line
Build a DB-less daily uplifting message site. Static UI; only daily JSON changes. Deploy with docker compose on Coolify, behind NPM reverse proxy.

## Product Requirements
1) Domain: goodgood.today
2) Daily generation time: 00:00 UTC (GMT 0) EVERY DAY
3) Daily content generated by LLM:
   - One uplifting, non-religious, culture-neutral sentence (short, supportive, motivating).
   - Translate into 20 widely used languages.
   - Generate a pleasing daily theme: background color, foreground (text) color, accent color.
4) Storage:
   - No database.
   - Store JSON files by date (immutable history).
   - Provide navigation for previous/next date + "Today" button.
5) Rendering:
   - HTML + JS remain constant (static).
   - Only JSON changes daily.
   - Browser preferred language auto-selected (navigator.languages), fallback to "en".
   - Allow manual language selection and remember it (localStorage).
6) Cron/scheduler:
   - Must run inside Docker container reliably.
   - Must also support manual one-off generation command for testing.

## Technical Constraints
- No nginx container. Assume NPM handles reverse proxy/SSL.
- Use Node.js for both:
  - Web service (static file server + /data route)
  - Generator service (LLM + filesystem)
- Use docker compose with two services:
  - web
  - generator
- Shared persistent volume: ./data mounted into both containers at /data

## Data Format (Daily JSON)
Daily JSON file path: `data/daily/YYYY-MM-DD.json`

Minimum schema:
{
  "date": "YYYY-MM-DD",
  "message": "base message (English)",
  "translations": { "en": "...", "ko": "...", ... },
  "theme": { "bg": "#RRGGBB", "fg": "#RRGGBB", "accent": "#RRGGBB" },
  "meta": {
    "model": "provider/model",
    "generated_at_utc": "ISO timestamp",
    "languages": ["en","es",...]
  }
}

Also maintain:
- data/index.json -> { "dates": ["YYYY-MM-DD", ...] } sorted ascending
- data/latest.json -> { "date": "YYYY-MM-DD" } and/or full copy of latest

## Language Set (20)
Use exactly these 20 language codes (stable):
en, es, fr, de, it, pt, ru, zh, ja, ko, ar, hi, bn, vi, th, tr, nl, sv, id, pl

## Reliability Requirements
- Idempotent generation: If today’s file exists, do not regenerate (unless a FORCE flag is set).
- Robust JSON parsing: If model returns markdown or extra text, extract JSON safely.
- Validate schema before writing files.

## Git + Devlog Requirements (VERY IMPORTANT)
A) Commit & push AFTER each milestone and at least after each session of meaningful changes.
B) For every commit, append a devlog entry and NEVER delete devlogs:
- Save under `docs/devlog/`
- One file per commit: `docs/devlog/YYYY-MM-DDTHH-mm-ssZ__<shortsha>.md`
- Include:
  - UTC timestamp
  - commit hash
  - commit message
  - what changed (bullet list)
  - tests executed and results
  - any bugs/issues found (even if unresolved)
C) Secrets must never be committed.

## Required Repo Artifacts to Produce
- README.md (local run, deployment on Coolify, operations, testing)
- docker-compose.yml
- .gitignore
- .env.example
- opencode.json (permissions configured to allow git automation)
- scripts/ (POSIX sh scripts):
  - local-up.sh, local-down.sh, generate-now.sh, healthcheck.sh
  - devlog-new.sh (creates per-commit devlog file)
- generator/ (Node):
  - scheduler (UTC 00:00)
  - generator script
  - tests
- web/ (static site):
  - index.html, app.js, styles.css
- web-server/ (Node static server):
  - serve static + /data
- .github/workflows/ci.yml (tests/build)

## Safety
- Avoid destructive shell commands. Never run `git push --force`.